/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package SpringBootSecu;

import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.beans.factory.annotation.Autowired;


import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

import java.util.Map;

import java.util.Optional;

@RestController
@SpringBootApplication
@Slf4j
public class App {

    public String getGreeting() {
	//loginJob();

	BCryptPasswordEncoder e = new BCryptPasswordEncoder();
	return e.encode("jinnai0");
    }

    public static void main(String[] args) {
	SpringApplication.run(App.class, args);

	String pw;
	Boolean b;
	BCryptPasswordEncoder e = new BCryptPasswordEncoder();
        System.out.println(pw = new App().getGreeting());
	b = e.matches("jinnai0", pw);
	System.out.println("b=" + b);
    }

	@Autowired
	LoginService service;

  @GetMapping("/loginInfo/{name}")
  public Map loginInfo(@PathVariable("name") String name) {
  //public Map loginInfo(@RequestParam("name", required = true) String name) {

	System.out.println("========================================");
	System.out.println("name:" + name);
	System.out.println("========================================");

	UserDetailsImpl impl = (UserDetailsImpl)
		service.loadUserByUsername(name);

    //log.debug("impl:", impl);i
	System.out.println("========================================");
	System.out.println("impl:" + impl);
	Login l = impl.getAccount();
	System.out.println("login:" + l);
	System.out.println("name:" + l.getName());
	System.out.println("pass:" + l.getPassword());
	System.out.println("========================================");

	return null;
  }
}
